import React from 'react';
import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, Line, ResponsiveContainer, ComposedChart, PieChart, Pie, Cell } from 'recharts';

// --- DATI DELLA DASHBOARD ---

// Dati trend mensili Gen-Mag 2025
const monthlyTrends = [
    { month: 'Gen', ricavi: 32780, unita: 5670, margine: 15.1, aov: 5.78, sku: 70 },
    { month: 'Feb', ricavi: 31311, unita: 5445, margine: 13.7, aov: 5.75, sku: 68 },
    { month: 'Mar', ricavi: 30105, unita: 5905, margine: -0.2, aov: 5.10, sku: 69 },
    { month: 'Apr', ricavi: 24924, unita: 4715, margine: 1.1, aov: 5.29, sku: 65 },
    { month: 'Mag', ricavi: 26402, unita: 4919, margine: 1.8, aov: 5.37, sku: 70 }
];

// Brand performance - DATI REALI VERIFICATI (Aggiornati)
const brandData = [
    { brand: 'Dr. Theiss', ricavi: 116969, share: 80.4, margine: 7.2 },
    { brand: 'Allga San', ricavi: 12938, share: 8.9, margine: 9.9 },
    { brand: 'Medipharmacosmetics', ricavi: 7398, share: 5.1, margine: -8.0 },
    { brand: 'Active Nutrient', ricavi: 6233, share: 4.3, margine: 5.4 },
    { brand: 'Lacalut', ricavi: 1984, share: 1.4, margine: 22.9 }
];

// KPI Summary 5 mesi
const kpiSummary = {
    ricaviTotali: 145522,
    unitaTotali: 26654,
    margineMediamo: 6.1,
    asp: 5.46, 
    skuMedio: 68,
    tassoResi: 0.5 
};

// Top ASIN performers - DATI REALI DAI CSV (Aggiornati)
const topASINs = [
    { asin: 'B00VXD970W', nome: 'Arnica Crema Effetto Termico', ricavi: 62168, mesi: 5, brand: 'Dr. Theiss' },
    { asin: 'B08VT6RYFL', nome: 'Mucoplant Kids Tuss', ricavi: 6999, mesi: 5, brand: 'Dr. Theiss' },
    { asin: 'B08D6SW7GR', nome: 'Mucoplant Piantaggine', ricavi: 5226, mesi: 5, brand: 'Dr. Theiss' },
    { asin: 'B01ELKX7ZY', nome: 'Mucoplant Soluzione Orale', ricavi: 4366, mesi: 5, brand: 'Dr. Theiss' },
    { asin: 'B08ZFJSSZ7', nome: 'Vitamina D3 K2', ricavi: 4096, mesi: 5, brand: 'Dr. Theiss' }
];

// Palette Colori per Grafici
const COLORS = ['#118AB2', '#06D6A0', '#FFD166', '#EF476F', '#073B4C'];

const AmazonVendorDashboard = () => {
    return (
        <div className="p-6 bg-gray-50 min-h-screen font-sans">
            <div className="max-w-7xl mx-auto">
                
                {/* Header */}
                <div className="bg-white rounded-lg shadow-lg p-6 mb-8 text-center">
                    <h1 className="text-3xl font-bold text-gray-800 mb-2">Amazon Vendor Central - Trend Analysis</h1>
                    <p className="text-gray-600">Naturwaren Italia | Gennaio-Maggio 2025 | Business Report</p>
                </div>

                {/* KPI Dashboard */}
                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6 mb-8">
                    <div className="bg-white p-4 rounded-lg shadow text-center">
                        <h3 className="text-sm font-medium text-gray-500">Ricavi Gen-Mag '25</h3>
                        <p className="text-3xl font-bold text-blue-600 mt-1">‚Ç¨{kpiSummary.ricaviTotali.toLocaleString()}</p>
                    </div>
                    <div className="bg-white p-4 rounded-lg shadow text-center">
                        <h3 className="text-sm font-medium text-gray-500">Unit√† Totali</h3>
                        <p className="text-3xl font-bold text-green-600 mt-1">{kpiSummary.unitaTotali.toLocaleString()}</p>
                    </div>
                    <div className="bg-white p-4 rounded-lg shadow text-center">
                        <h3 className="text-sm font-medium text-gray-500">Margine Avg Amazon</h3>
                        <p className="text-3xl font-bold text-red-600 mt-1">{kpiSummary.margineMediamo}%</p>
                    </div>
                    <div className="bg-white p-4 rounded-lg shadow text-center">
                        <h3 className="text-sm font-medium text-gray-500">ASP</h3>
                        <p className="text-3xl font-bold text-orange-600 mt-1">‚Ç¨{kpiSummary.asp}</p>
                    </div>
                    <div className="bg-white p-4 rounded-lg shadow text-center">
                        <h3 className="text-sm font-medium text-gray-500">SKU Attivi</h3>
                        <p className="text-3xl font-bold text-purple-600 mt-1">{kpiSummary.skuMedio}</p>
                    </div>
                    <div className="bg-white p-4 rounded-lg shadow text-center">
                        <h3 className="text-sm font-medium text-gray-500">Tasso Resi</h3>
                        <p className="text-3xl font-bold text-teal-600 mt-1">{kpiSummary.tassoResi}%</p>
                    </div>
                </div>

                {/* Note Metodologiche */}
                <div className="bg-white border-l-4 border-gray-300 p-4 rounded-r-lg shadow mb-8 text-sm">
                    <h4 className="font-bold text-gray-700 mb-2">üìä Note Metodologiche</h4>
                    <ul className="list-none space-y-1 text-gray-600">
                        <li><strong>ASP (Average Selling Price):</strong> Ricavi √∑ Unit√†. Indica il prezzo medio di vendita per singolo prodotto.</li>
                        <li><strong>Margine Amazon:</strong> (Ricavi - COGS) √∑ Ricavi. Rappresenta il margine che Amazon applica rivendendo i prodotti.</li>
                        <li><strong>Tasso Resi:</strong> Resi Cliente √∑ Unit√† Spedite. Percentuale di prodotti restituiti dai clienti.</li>
                    </ul>
                </div>

                {/* Main Trend Chart */}
                <div className="grid grid-cols-1 gap-8 mb-8">
                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h2 className="text-xl font-bold mb-4 text-center">üìà Andamento Ricavi e Volumi</h2>
                        <ResponsiveContainer width="100%" height={300}>
                            <ComposedChart data={monthlyTrends}>
                                <CartesianGrid strokeDasharray="3 3" />
                                <XAxis dataKey="month" />
                                <YAxis yAxisId="left" tickFormatter={(val) => `‚Ç¨${val/1000}k`}/>
                                <YAxis yAxisId="right" orientation="right" tickFormatter={(val) => `${val/1000}k`}/>
                                <Tooltip formatter={(value, name) => [ name === 'Ricavi' ? `‚Ç¨${value.toLocaleString()}` : value.toLocaleString(), name ]} />
                                <Legend />
                                <Bar yAxisId="left" dataKey="ricavi" fill={COLORS[0]} name="Ricavi" />
                                <Line yAxisId="right" type="monotone" dataKey="unita" stroke={COLORS[2]} strokeWidth={3} name="Unit√†" />
                            </ComposedChart>
                        </ResponsiveContainer>
                    </div>
                </div>

                {/* Brand Analysis */}
                <div className="grid grid-cols-1 lg:grid-cols-5 gap-8 mb-8">
                    {/* Brand Performance Table */}
                    <div className="bg-white p-6 rounded-lg shadow-lg lg:col-span-3">
                        <h2 className="text-xl font-bold mb-4">üèÜ Performance per Brand (5 Mesi)</h2>
                        <div className="overflow-x-auto">
                            <table className="w-full text-sm">
                                <thead>
                                    <tr className="border-b text-left">
                                        <th className="p-2 font-semibold">Brand</th>
                                        <th className="p-2 font-semibold text-right">Ricavi</th>
                                        <th className="p-2 font-semibold text-right">Share</th>
                                        <th className="p-2 font-semibold text-right">Margine</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {brandData.map((brand, index) => (
                                        <tr key={index} className="border-b hover:bg-gray-50">
                                            <td className="p-2 font-bold text-gray-700">{brand.brand}</td>
                                            <td className="p-2 text-right">‚Ç¨{brand.ricavi.toLocaleString()}</td>
                                            <td className="p-2 text-right font-bold">{brand.share}%</td>
                                            <td className="p-2 text-right">
                                                <span className={`px-2 py-1 rounded-full text-xs font-semibold ${ brand.margine > 15 ? 'bg-green-100 text-green-800' : brand.margine > 5 ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800' }`}>
                                                    {brand.margine.toFixed(1)}%
                                                </span>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {/* Market Share Pie */}
                    <div className="bg-white p-6 rounded-lg shadow-lg lg:col-span-2">
                        <h2 className="text-xl font-bold mb-4 text-center">ü•ß Ripartizione Ricavi per Brand</h2>
                        <ResponsiveContainer width="100%" height={300}>
                            <PieChart>
                                <Pie data={brandData} cx="50%" cy="50%" labelLine={false} label={({ brand, share }) => `${brand} ${share}%`} outerRadius={100} fill="#8884d8" dataKey="ricavi">
                                    {brandData.map((entry, index) => (
                                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                                    ))}
                                </Pie>
                                <Tooltip formatter={(value) => [`‚Ç¨${value.toLocaleString()}`, 'Ricavi']} />
                                <Legend />
                            </PieChart>
                        </ResponsiveContainer>
                    </div>
                </div>

                {/* Top Products Analysis */}
                <div className="bg-white p-6 rounded-lg shadow-lg mb-8">
                    <h2 className="text-xl font-bold mb-4">üéØ Top 5 ASIN - Performance (5 Mesi)</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                        {topASINs.map((product, index) => (
                            <div key={index} className="border rounded-lg p-4 hover:shadow-md transition-shadow flex flex-col">
                                <div className="text-xs text-gray-500 mb-1"><strong>#{index + 1}</strong> | {product.brand}</div>
                                <div className="text-sm font-semibold mb-2 flex-grow">{product.nome}</div>
                                <div className="font-mono text-xs text-blue-600 mb-2">{product.asin}</div>
                                <div className="text-xl font-bold text-green-700">‚Ç¨{product.ricavi.toLocaleString()}</div>
                            </div>
                        ))}
                    </div>
                </div>
                
                {/* Seller Channel Updates */}
                <div className="bg-white p-8 rounded-lg shadow-lg mb-8">
                    <h2 className="text-2xl font-bold mb-6 text-center">Aggiornamenti Canale Seller</h2>
                    <div className="border-l-4 border-green-500 pl-4 py-2">
                            <h3 className="font-bold text-green-700 mb-2 text-lg">Lancio Imminente e Strategia Bundle</h3>
                            <p className="text-sm text-gray-600">
                                Tutto √® pronto per la partenza: la prima spedizione FBA √® in preparazione e verr√† inviata nei prossimi giorni. Come gi√† definito, la strategia di differenziazione tramite bundle e multipack esclusivi rimane un pilastro fondamentale del canale Seller. Questa tattica ci permetter√† di creare proposte uniche, incrementare l'ASP e rafforzare la nostra posizione sul mercato.
                            </p>
                        </div>
                </div>

                {/* Strategic Action Plan */}
                <div className="bg-white p-8 rounded-lg shadow-lg">
                    <h2 className="text-2xl font-bold mb-6 text-center">Prossimi Passi e Strategie Future</h2>
                    <div className="space-y-6">
                        <div className="border-l-4 border-blue-500 pl-4 py-2">
                            <h3 className="font-bold text-blue-700 mb-2 text-lg">‚òÄÔ∏è Ottimizzazione Prodotti Estivi</h3>
                            <p className="text-sm text-gray-600">
                                In vista della stagione estiva, l'attenzione √® focalizzata sull'ottimizzazione dei prodotti solari. Sono gi√† state avviate attivit√† di miglioramento dei listing e dei contenuti A+. Parallelamente, sono state attivate campagne pubblicitarie mirate per massimizzare la visibilit√† e stimolare il fatturato.
                            </p>
                        </div>
                        <div className="border-l-4 border-orange-500 pl-4 py-2">
                            <h3 className="font-bold text-orange-700 mb-2 text-lg">üîç Analisi e Diversificazione del Catalogo</h3>
                            <p className="text-sm text-gray-600">
                                Sar√† condotta un'analisi approfondita per identificare nuove categorie di prodotti o brand complementari con margini di profitto pi√π elevati. L'obiettivo √® ridurre la dipendenza dai singoli prodotti "hero", bilanciare il rischio ed esplorare nuove opportunit√†, lavorando anche per sbloccare il potenziale di vendita dei prodotti attualmente bloccati o con performance inferiori alle attese.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    );
};

export default AmazonVendorDashboard;
